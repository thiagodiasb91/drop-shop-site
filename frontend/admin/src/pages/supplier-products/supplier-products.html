<div x-data="getData()" class="supplier-products-page">
  <div x-show="loading" class="loader"></div>
  <!-- HEADER -->
  <header class="page-header" x-show="!loading">
    <div>
      <h1>Vincular produtos</h1>
      <p>
        Fornecedor:
        <strong x-text="supplier.email || '—'"></strong>
      </p>
    </div>
  </header>

  <!-- TOOLBAR -->
  <div class="list-toolbar" x-show="!loading">
    <input type="text" placeholder="Buscar produto" x-model="search" />

    <div class="filter-tabs">
      <button :class="{ active: filter === 'all' }" @click="filter = 'all'">
        Todos
      </button>

      <button :class="{ active: filter === 'linked' }" @click="filter = 'linked'">
        Vinculados
      </button>

      <button :class="{ active: filter === 'unlinked' }" @click="filter = 'unlinked'">
        Não vinculados
      </button>
    </div>
  </div>

    <!-- LISTA -->
    <template x-for="product in filteredProducts" :key="product.id" x-show="!loading">
      <div class="entity-card">

        <!-- PRODUTO -->
        <div class="entity-item-row">
          <label class="checkbox-row">
            <input type="checkbox" x-model="product.selected" />
            <span x-text="product.name"></span>
          </label>

          <span class="hint">
            <span x-text="product.skus.length"></span> SKUs
          </span>
        </div>

        <!-- SKUs -->
        <div x-show="product.selected" x-transition class="sku-list">
          <template x-for="sku in product.skus" :key="sku.key">
            <div class="sku-row">
              <div class="sku-attributes">
                <label x-text="formatSkuAttributes(sku.attributes)"></label>
              </div>

              <div class="sku-input">
                <input type="text" placeholder="SKU do fornecedor" x-model="sku.supplierSku" />
              </div>

              <div class="sku-price">
                <input type="number" step="0.01" placeholder="0,00" x-model="sku.costPrice" />
              </div>
            </div>
          </template>
        </div>

      </div>
    </template>

    <!-- PAGINAÇÃO -->
    <div class="pagination" x-show="nextCursor" x-show="!loading">
      <button @click="loadProducts()">Carregar mais</button>
    </div>

    <!-- AÇÕES -->
    <div class="page-actions sticky" x-show="!loading">
      <button class="btn-secondary" @click="goBack()">
        Voltar
      </button>

      <button class="btn-primary" @click="saveLinks()" :disabled="loading">
        Salvar vínculos
      </button>
    </div>

  </div>